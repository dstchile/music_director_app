<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
 <title>Documento sin título</title>
    <link href="css/estilos.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="css/fontello.css" type="text/css">
	<script type="text/javascript" src="cordova.js"></script>
    <script src="js/jquery-3.1.1.js"></script>
	<script>
	document.addEventListener("deviceready", lectura_inicial, false);
		function lectura_inicial()
			{
				lectura_datos();
				console.log("carga de BD");
			}
		function lectura_datos(db)
			{
			var db = window.openDatabase("music_director_app", "1.0", "music_director_app", 2000000); //will create database Dummy_DB or open it
			db.transaction(queryDB,errorCB);
			function queryDB(tx)
				{
				tx.executeSql('SELECT * FROM datos_director ',[],querySuccess,errorCB);
				console.log( "Leyendo datos guardados." );
				}
				function errorCB(err) 
				{
				if (err.code!=0)
					{
					alert("1Error processing SQL: "+err.code);
					}
				}
				function querySuccess(tx,result)
				{
				
				console.log( "generando query." );
				var existen_datos=false;
				$.each(result.rows,function(index)
					{
					var existen_datos=true;
					});
				if (result.rows.length>=1)
					{
					console.log("con datos");
					var ruta="listado.html";
					document.getElementById("retorno").href = ruta;
					}
				else
					{
					console.log("sin datos");
					var ruta="index.html";
					document.getElementById("retorno").href = ruta;
					}
				
				}
			}        
        
function guardar_datos(){
	var nombre_director = document.getElementById('nombre_director').value;
	var numero_telefono = document.getElementById('numero_telefono').value;
	
	var nombre_directorv = nombre_director.replace(/'/g,"''");
	var numero_telefonov = numero_telefono.replace(/'/g,"''");
	
	if(nombre_director=='')
		{
		alert("Debe especificar el nombre del Director");
		}
	else if(numero_telefono=='')
		{
			alert("Debe especificar el cantente o grupo de la Cancion "+titulo);
		}
	else
		{
		var db = window.openDatabase("music_director_app", "1.0", "music_director_app", 2000000); //will create database Dummy_DB or open it
		db.transaction(populateDB, errorCB, successCB);
		function populateDB(tx) 
			{
			tx.executeSql("INSERT INTO datos_director (nombre_usuario,numero_telefono)VALUES('"+nombre_directorv+"','"+numero_telefonov+"')");														
			}
		function errorCB(err) 
			{
			alert("Error processing 2 SQL: "+err.code);
			}
		function successCB() 
			{
				alert("Datos guardados correctamente!")
				location.href="listado.html";
			}
		}
	}


	</script>
</head>

<body>
<a href="" id="retorno" class="boton2 ancho-back"><span class="icon-left-open"></span></a><button class="boton2" style="width: 90vw" disabled>DATOS DIRECTOR</button>
<div class="titulo_cancion">
	<font color="white">Nombre Director(use un nickname sencillo)</font>
</div>
<div class="titulo_cancion centrado">
	<input type="text" id="nombre_director" name="nombre_director" >
</div>
<div class="titulo_cancion">
	<font color="white">Número de teléfono</font>
</div>
<div class="titulo_cancion centrado">
	<input type="text" id="numero_telefono" name="numero_telefono" >
</div>
<div class="titulo_cancion">
</div>
<div id="letra_can" class="letra_cancion">
	<div style="width: 45%;"><span class="icon-edit"></span>El nombre de Director es usado por la Aplicación para conectarse con los músicos, es recomendable usar un nombre facil de identificar por tus músicos para que puedan sincronizar facilmente</div>
	<div style="width: 45%;"><span class="icon-edit"></span>El número de teléfono es usado por la Aplicación para descargar las canciones creadas desde la página web, te ayudará a ahorrar tiempo en la creación de canciones, de esta manera será mucho más rápido subir tus canciones a la aplicación</div>
  <div style="width: 55%;" align="right"><input type="checkbox" id="check"><label id="lab" onClick="reajustar()" for="check"></label></div>
</div>
<div id="boton_guardar" class="base_cancion" align="center">
	<input type="button" id="guardar" name="guardar" onClick="guardar_datos()" value="Guardar">	
</div>
</body>
</html>