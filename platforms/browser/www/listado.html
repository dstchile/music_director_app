<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <title>Music Director</title>
    <script src="js/jquery-3.1.1.js"></script>
    <link href="css/estilos.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="css/fontello.css" type="text/css">
    <script>
	document.addEventListener("deviceready", lectura_inicial, false);
	function lectura_inicial(ob,x)
		{
			if(x==undefined){x='';}
			var db = window.openDatabase("music_director_app", "1.0", "music_director_app", 2000000); //will create database Dummy_DB or open it
			if(ob!='titulo_cancion' && ob!='cantante' && ob!='tono')
			{
				ob='';
			}
			if(ob=='')
				{
					document.getElementById('boton_cancion').className="boton2_activo ancho-b_song";
					var ob="titulo_cancion";
					lista_programas(db,ob,x);
				}
			else
				{
					document.getElementById('boton_cancion').className="boton2 ancho-b_song";
					lista_programas(db,ob,x);
				}
		}
	function lista_programas(db,ob,x){
	db.transaction(queryDB,errorCB);
	function queryDB(tx)
		{
		var ordenar = ob;
		var busq = x;
		if(busq!='')
		{
			tx.executeSql('SELECT * FROM director WHERE titulo_cancion LIKE "%'+busq+'%" OR cantante LIKE "%'+busq+'%" OR letra_cancion LIKE "%'+busq+'%" ORDER BY "'+ordenar+'" ',[],querySuccess,errorCB);
		}
		else
		{
			tx.executeSql('SELECT * FROM director ORDER BY "'+ordenar+'" ',[],querySuccess,errorCB);
		}
		//alert(busqv);
		
		console.log( "Leyendo datos guardados." );
		}
		function errorCB(err) 
		{
		alert("Error processing SQL: "+err.code);
		}
		function querySuccess(tx,result)
		{
		console.log( "generando query." );
		$('#Listado_canciones').empty();
		$.each(result.rows,function(index)
			{
				var row = result.rows.item(index);
				var id_cancion=row['id'];
				var titulo=row['titulo_cancion'];
				var cantante=row['cantante'];
				var velocidad=row['velocidad'];
				var compas=row['compas'];
				var letra_cancion=row['letra_cancion'];
				var tono=row['tono'];
			
	 		$('#Listado_canciones').append('<li><a href="#?v1='+id_cancion+'"><p><span class="icon-headphones"> - <font style="font-size:16px; font-weight:bold">'+row['titulo_cancion']+'</font></span></p><p><span class="icon-mic"> - '+row['cantante']+'</span></p><p><span class="icon-music"> - '+row['tono']+'</span></p></a></li>');
			});
 		}
	}
	function ordenar_por(orde){
		var z = document.getElementById('busqueda').value;
		if(orde=='ocancion')
		{
			var ob="titulo_cancion";
			lectura_inicial(ob,z)
			document.getElementById('boton_cancion').className="boton2_activo ancho-b_song";
			document.getElementById('valor_orden').value="titulo_cancion";			
			document.getElementById('boton_cantante').className="boton2 ancho-b_songer";
			document.getElementById('boton_tono').className="boton2 ancho-b_tono";
		}
		else if(orde=='ocantante')
		{
			var ob="cantante";
			lectura_inicial(ob,z)
			document.getElementById('boton_cantante').className="boton2_activo ancho-b_songer";
			document.getElementById('valor_orden').value="cantante";
			document.getElementById('boton_cancion').className="boton2 ancho-b_song";
			document.getElementById('boton_tono').className="boton2 ancho-b_tono";	
		}
		else if(orde=='otono')
		{
			var ob="tono";
			lectura_inicial(ob,z)
			document.getElementById('boton_tono').className="boton2_activo ancho-b_tono";
			document.getElementById('valor_orden').value="tono";
			document.getElementById('boton_cantante').className="boton2 ancho-b_songer";
			document.getElementById('boton_cancion').className="boton2 ancho-b_song";
		}
	}
	</script>
    </head>
    <body>
      <script type="text/javascript" src="cordova.js"></script>
      <a href="index.html" title="lista" class="boton2 ancho-back"><span class="icon-left-open"></span></a><a href="#" class="boton2_activo ancho-b_listado"><span class="icon-th-list"></span></a><a href="#" class="boton2 ancho-b_grupos"><span class="icon-group"></span></a><a href="cancion_nueva.html" class="boton2 ancho-b_agregar"><span class="icon-plus"></span></a><a href="#" class="boton2 ancho-b_config"><span class="icon-cog"></span></a>
	  <div class="busqueda"><span class="icon-search"></span><input type="text" name="busqueda" id="busqueda" placeholder="Cancion / Cantante / Grupo / Letra" onKeyUp="lectura_inicial(valor_orden.value,this.value); ordernar_por(valor_orden.value)" onBlur="lectura_inicial(valor_orden.value,this.value); ordernar_por(valor_orden.value)"></div>
    <div class="listado">
    <ul id="Listado_canciones" class="listado_canciones">
    </ul>
    </div>
	<div class="bot">
		<input type="hidden" id="valor_orden"><button class="boton2 ancho-b_ordenar" disabled>Ordenar por:</button><button id="boton_cancion" class="boton2 ancho-b_song" onClick="ordenar_por('ocancion')"><span class="icon-headphones"></span></button><button id="boton_cantante" class="boton2 ancho-b_songer" onClick="ordenar_por('ocantante')"><span class="icon-mic"></span></button><button id="boton_tono" class="boton2 ancho-b_tono" onClick="ordenar_por('otono')"><span class="icon-music"></span></button>
	</div>
	<p>&nbsp;</p>
    </body>
</html>
